import{a as d,e as C,j as e,H as D,b as j}from"./app-ChGtWkZu.js";import{D as K}from"./DosenSidebar-Bn9LSuQK.js";import{H as T}from"./Header-CIFYwiEZ.js";/* empty css            */function A({mataKuliahList:f,kelasList:N}){const[u,h]=d.useState(!0),[p,b]=d.useState(!1),[x,k]=d.useState([]),[g,y]=d.useState(!1),[t,n]=d.useState({mata_kuliah_id:"",kelas_id:"",semester:"Ganjil",tahun_ajaran:"2024/2025",nilai:[]}),[c,v]=d.useState({});d.useEffect(()=>{const a=localStorage.getItem("darkMode")==="true";b(a)},[]),d.useEffect(()=>{t.kelas_id&&t.mata_kuliah_id?w():(k([]),n(a=>({...a,nilai:[]})))},[t.kelas_id,t.mata_kuliah_id]);const w=async()=>{y(!0);try{const s=(await C.get("/dosen/nilai/get-mahasiswa",{params:{kelas_id:t.kelas_id,mata_kuliah_id:t.mata_kuliah_id}})).data.data;k(s);const r=s.map(i=>({mahasiswa_id:i.id,tugas:i.nilai?.tugas||"",uts:i.nilai?.uts||"",uas:i.nilai?.uas||""}));n(i=>({...i,nilai:r}))}catch(a){console.error("Error loading mahasiswa:",a),alert(a.response?.data?.message||"Gagal memuat data mahasiswa")}finally{y(!1)}},m=(a,s,r)=>{r!==""&&(isNaN(Number(r))||Number(r)<0||Number(r)>100)||n(i=>({...i,nilai:i.nilai.map(o=>o.mahasiswa_id===a?{...o,[s]:r}:o)}))},_=(a,s,r)=>{const i=parseFloat(a)||0,o=parseFloat(s)||0,l=parseFloat(r)||0;return(i*.3+o*.3+l*.4).toFixed(2)},M=a=>a>=85?"A":a>=70?"B":a>=60?"C":a>=50?"D":"E",S=a=>{if(a.preventDefault(),!t.mata_kuliah_id||!t.kelas_id){alert("Pilih Mata Kuliah dan Kelas terlebih dahulu");return}if(t.nilai.length===0){alert("Tidak ada mahasiswa yang akan diinput nilai");return}const s={mata_kuliah_id:t.mata_kuliah_id,kelas_id:t.kelas_id,semester:t.semester,tahun_ajaran:t.tahun_ajaran,nilai:t.nilai};j.post("/dosen/nilai",s,{onError:r=>{v(r),console.error("Validation errors:",r)}})};return e.jsx("div",{className:p?"dark":"",children:e.jsxs("div",{className:"min-h-screen bg-gray-100 dark:bg-gray-900 transition-colors duration-300",children:[e.jsx(D,{title:"Input Nilai"}),e.jsx(K,{sidebarOpen:u,setSidebarOpen:h,activeMenu:"nilai"}),e.jsxs("div",{className:`p-4 transition-all duration-300 ${u?"lg:ml-64":"lg:ml-0"}`,children:[e.jsx(T,{sidebarOpen:u,setSidebarOpen:h,darkMode:p,setDarkMode:b,title:"Input Nilai",subtitle:"Input nilai mahasiswa untuk mata kuliah yang Anda ajar"}),e.jsxs("div",{className:"mt-6 max-w-7xl",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Input Nilai Mahasiswa"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Input nilai Tugas, UTS, dan UAS untuk mahasiswa"})]}),e.jsxs("form",{onSubmit:S,children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Pilih Kelas dan Mata Kuliah"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["Mata Kuliah ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:t.mata_kuliah_id,onChange:a=>n(s=>({...s,mata_kuliah_id:a.target.value})),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",required:!0,children:[e.jsx("option",{value:"",children:"Pilih Mata Kuliah"}),f.map(a=>e.jsxs("option",{value:a.id,children:[a.kode_mk," - ",a.nama_mk]},a.id))]}),c.mata_kuliah_id&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:c.mata_kuliah_id})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["Kelas ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:t.kelas_id,onChange:a=>n(s=>({...s,kelas_id:a.target.value})),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",required:!0,children:[e.jsx("option",{value:"",children:"Pilih Kelas"}),N.map(a=>e.jsx("option",{value:a.id,children:a.nama_kelas},a.id))]}),c.kelas_id&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:c.kelas_id})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["Semester ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:t.semester,onChange:a=>n(s=>({...s,semester:a.target.value})),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",required:!0,children:[e.jsx("option",{value:"Ganjil",children:"Ganjil"}),e.jsx("option",{value:"Genap",children:"Genap"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["Tahun Ajaran ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:t.tahun_ajaran,onChange:a=>n(s=>({...s,tahun_ajaran:a.target.value})),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",required:!0,children:[e.jsx("option",{value:"2023/2024",children:"2023/2024"}),e.jsx("option",{value:"2024/2025",children:"2024/2025"}),e.jsx("option",{value:"2025/2026",children:"2025/2026"}),e.jsx("option",{value:"2026/2027",children:"2026/2027"})]})]})]})]}),g&&e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-12 text-center mb-6",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mb-4"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Memuat data mahasiswa..."})]})}),!g&&x.length>0&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-4 bg-gradient-to-r from-blue-600 to-purple-600",children:[e.jsxs("h3",{className:"text-lg font-semibold text-white",children:["Daftar Mahasiswa (",x.length," orang)"]}),e.jsx("p",{className:"text-blue-100 text-sm",children:"Nilai: 0-100 | Bobot: Tugas 30% + UTS 30% + UAS 40%"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider",children:"No"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider",children:"NIM"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider",children:"Nama Mahasiswa"}),e.jsx("th",{className:"px-6 py-3 text-center text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider",children:"Tugas (30%)"}),e.jsx("th",{className:"px-6 py-3 text-center text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider",children:"UTS (30%)"}),e.jsx("th",{className:"px-6 py-3 text-center text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider",children:"UAS (40%)"}),e.jsx("th",{className:"px-6 py-3 text-center text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider",children:"Nilai Akhir"}),e.jsx("th",{className:"px-6 py-3 text-center text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider",children:"Grade"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:x.map((a,s)=>{const r=t.nilai.find(l=>l.mahasiswa_id===a.id),i=r?_(r.tugas,r.uts,r.uas):"-",o=typeof i=="number"?M(i):"-";return e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/50 transition",children:[e.jsx("td",{className:"px-6 py-4 text-sm text-gray-700 dark:text-gray-300",children:s+1}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-700 dark:text-gray-300",children:a.nim}),e.jsx("td",{className:"px-6 py-4 text-sm font-medium text-gray-900 dark:text-white",children:a.nama}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx("input",{type:"number",min:"0",max:"100",step:"0.01",value:r?.tugas||"",onChange:l=>m(a.id,"tugas",l.target.value),className:"w-20 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white text-center",placeholder:"0-100"})}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx("input",{type:"number",min:"0",max:"100",step:"0.01",value:r?.uts||"",onChange:l=>m(a.id,"uts",l.target.value),className:"w-20 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white text-center",placeholder:"0-100"})}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx("input",{type:"number",min:"0",max:"100",step:"0.01",value:r?.uas||"",onChange:l=>m(a.id,"uas",l.target.value),className:"w-20 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white text-center",placeholder:"0-100"})}),e.jsx("td",{className:"px-6 py-4 text-center text-sm font-bold text-blue-600 dark:text-blue-400",children:i}),e.jsx("td",{className:"px-6 py-4 text-center text-sm font-bold text-purple-600 dark:text-purple-400",children:o})]},a.id)})})]})}),e.jsxs("div",{className:"px-6 py-4 bg-gray-50 dark:bg-gray-700/50 border-t border-gray-200 dark:border-gray-700 flex justify-between",children:[e.jsx("button",{type:"button",onClick:()=>j.get("/dosen/nilai"),className:"px-6 py-2 bg-gray-300 dark:bg-gray-700 hover:bg-gray-400 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 rounded-lg font-semibold transition",children:"Batal"}),e.jsx("button",{type:"submit",className:"px-8 py-2 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white rounded-lg font-semibold shadow-lg transition",children:"Simpan Nilai"})]})]}),!g&&x.length===0&&t.kelas_id&&t.mata_kuliah_id&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-12 text-center",children:[e.jsx("svg",{className:"w-16 h-16 text-gray-400 dark:text-gray-600 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-lg",children:"Tidak ada mahasiswa di kelas ini"})]}),!t.kelas_id||!t.mata_kuliah_id?e.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border-l-4 border-blue-600 p-6 rounded-lg",children:e.jsxs("div",{className:"flex",children:[e.jsx("svg",{className:"w-6 h-6 text-blue-600 dark:text-blue-400 mr-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-blue-900 dark:text-blue-300 font-semibold mb-1",children:"Informasi"}),e.jsx("p",{className:"text-blue-700 dark:text-blue-400 text-sm",children:"Silakan pilih Mata Kuliah dan Kelas untuk menampilkan daftar mahasiswa"})]})]})}):null]})]})]})]})})}export{A as default};
