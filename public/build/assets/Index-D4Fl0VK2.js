import{j as e,u as X,a as s,H as Y,b}from"./app-rqAKm7F0.js";import{S as Z,H as D}from"./Header-Dgp0CeEs.js";import{I as ee,D as ae,T as te}from"./Toast-D0EGW6dg.js";/* empty css            */function re({loading:l=!1,disabled:n=!1,children:x,className:r="",type:i="button",onClick:d}){return e.jsxs("button",{type:i,onClick:d,disabled:n||l,className:`relative inline-flex items-center justify-center ${r} ${n||l?"opacity-70 cursor-not-allowed":""}`,children:[l&&e.jsx("div",{className:"absolute left-4",children:e.jsxs("svg",{className:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}),e.jsx("span",{className:l?"ml-6":"",children:x})]})}function A({show:l,onClose:n,onSubmit:x,formData:r,setFormData:i,prodis:d,kelas:u,isEdit:o=!1,loading:c=!1}){if(!l)return null;const k=r.prodi_id?u?.filter(t=>t.prodi_id===parseInt(r.prodi_id)):u;return e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50 flex items-start justify-center p-4",children:e.jsxs("div",{className:"relative top-4 md:top-10 mx-auto p-4 md:p-5 border w-full max-w-2xl shadow-lg rounded-md bg-white dark:bg-gray-800",children:[e.jsx("h3",{className:"text-lg font-medium leading-6 text-gray-900 dark:text-white mb-4",children:o?"Edit Data Mahasiswa":"Tambah Data Mahasiswa"}),e.jsxs("form",{onSubmit:x,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"NIM *"}),e.jsx("input",{type:"text",required:!0,value:r.nim,onChange:t=>i({...r,nim:t.target.value}),className:"w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Nama *"}),e.jsx("input",{type:"text",required:!0,value:r.nama,onChange:t=>i({...r,nama:t.target.value}),className:"w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Prodi *"}),e.jsxs("select",{required:!0,value:r.prodi_id,onChange:t=>i({...r,prodi_id:t.target.value,kelas_id:""}),className:"w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm",children:[e.jsx("option",{value:"",children:"Pilih Prodi"}),d.map(t=>e.jsxs("option",{value:t.id,children:[t.nama_prodi," - ",t.fakultas?.nama_fakultas]},t.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Kelas"}),e.jsxs("select",{value:r.kelas_id||"",onChange:t=>i({...r,kelas_id:t.target.value}),className:"w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm",disabled:!r.prodi_id,children:[e.jsx("option",{value:"",children:"Pilih Kelas"}),k?.map(t=>e.jsxs("option",{value:t.id,children:[t.nama_kelas," - Semester ",t.semester]},t.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Angkatan *"}),e.jsx("input",{type:"number",required:!0,value:r.angkatan,onChange:t=>i({...r,angkatan:t.target.value}),className:"w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Jenis Kelamin *"}),e.jsxs("select",{required:!0,value:r.jenis_kelamin,onChange:t=>i({...r,jenis_kelamin:t.target.value}),className:"w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm",children:[e.jsx("option",{value:"L",children:"Laki-laki"}),e.jsx("option",{value:"P",children:"Perempuan"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Email *"}),e.jsx("input",{type:"email",required:!0,value:r.email,onChange:t=>i({...r,email:t.target.value}),className:"w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Password ",o&&"(kosongkan jika tidak diubah)",!o&&" *"]}),e.jsx("input",{type:"password",required:!o,value:r.password,onChange:t=>i({...r,password:t.target.value}),className:"w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Alamat"}),e.jsx("textarea",{rows:3,value:r.alamat,onChange:t=>i({...r,alamat:t.target.value}),className:"w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm"})]})]}),e.jsxs("div",{className:"flex gap-2 mt-6",children:[e.jsx(re,{type:"submit",loading:c,className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 disabled:opacity-50",children:o?"Update":"Simpan"}),e.jsx("button",{type:"button",onClick:n,disabled:c,className:"flex-1 bg-gray-300 dark:bg-gray-600 text-gray-700 dark:text-gray-300 px-4 py-2 rounded-md hover:bg-gray-400 dark:hover:bg-gray-500 disabled:opacity-50",children:"Batal"})]})]})]})})}function oe({mahasiswa:l,prodis:n,kelas:x,filters:r}){const d=X().props,[u,o]=s.useState(!1),[c,k]=s.useState({type:"info",message:"",details:[]});console.log("=== FULL PAGE PROPS ===",d),console.log("Props keys:",Object.keys(d)),console.log("Auth:",d.auth),console.log("Flash:",d.flash),console.log("Errors:",d.errors);const[t,H]=s.useState(()=>{if(typeof window<"u"){const a=localStorage.getItem("darkMode");return a!==null?a==="true":window.matchMedia("(prefers-color-scheme: dark)").matches}return!1}),[j,L]=s.useState(()=>typeof window<"u"?window.innerWidth>=1024:!0),[E,R]=s.useState(r.search||""),[P,B]=s.useState(r.prodi_id||""),[$,v]=s.useState(!1),[N,S]=s.useState(null),[F,C]=s.useState(!1),[q,M]=s.useState(!1),[z,_]=s.useState(!1),[g,h]=s.useState(null),[T,m]=s.useState(!1),[f,p]=s.useState({nim:"",nama:"",prodi_id:"",kelas_id:"",angkatan:"",jenis_kelamin:"L",alamat:"",email:"",password:""});s.useEffect(()=>{t?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),localStorage.setItem("darkMode",String(t))},[t]),s.useEffect(()=>{console.log("=== Flash Effect Triggered ==="),console.log("Props in effect:",d),console.log("Flash in effect:",d?.flash);const a=d?.flash;o(!1),setTimeout(()=>{a?.success?(console.log("Setting SUCCESS toast with message:",a.success),k({type:"success",message:a.success,details:a.import_errors||[]}),o(!0),console.log("Toast state set to TRUE")):a?.error&&(console.log("Setting ERROR toast with message:",a.error),k({type:"error",message:a.error,details:a.import_errors||[]}),o(!0),console.log("Toast state set to TRUE"))},100)},[d]);const I=()=>({nim:"",nama:"",prodi_id:"",kelas_id:"",angkatan:"",jenis_kelamin:"L",alamat:"",email:"",password:""}),K=a=>{a.preventDefault(),b.get("/admin/mahasiswa",{search:E,prodi_id:P},{preserveState:!0,replace:!0})},U=a=>{h(a),_(!0)},W=()=>{g&&b.post(`/admin/mahasiswa/${g?.id}`,{_method:"DELETE"},{onSuccess:()=>{_(!1),h(null)}})},O=()=>{p(I()),C(!0)},J=a=>{h(a),p({nim:a.nim,nama:a.nama,prodi_id:String(a.prodi_id),kelas_id:a.kelas_id?String(a.kelas_id):"",angkatan:String(a.angkatan),jenis_kelamin:a.jenis_kelamin,alamat:a.alamat||"",email:a.user?.email||"",password:""}),M(!0)},V=a=>{a.preventDefault(),m(!0),b.post("/admin/mahasiswa",f,{onSuccess:()=>{C(!1),p(I()),m(!1)},onError:()=>{m(!1)},onFinish:()=>{m(!1)}})},G=a=>{a.preventDefault(),m(!0),b.post(`/admin/mahasiswa/${g?.id}`,{...f,_method:"PUT"},{onSuccess:()=>{M(!1),h(null),m(!1)},onError:()=>{m(!1)},onFinish:()=>{m(!1)}})},Q=a=>{if(a.preventDefault(),!N){alert("Silakan pilih file terlebih dahulu");return}const w=new FormData;w.append("file",N),b.post("/admin/mahasiswa/import",w,{onSuccess:y=>{console.log("Import success:",y.props.flash),v(!1),S(null)},onError:y=>{console.log("Import errors:",y)}})};return console.log("Rendering toast check - showToast:",u,"toastConfig:",c),e.jsxs("div",{className:t?"dark":"",children:[e.jsxs("div",{className:"min-h-screen bg-gray-100 dark:bg-gray-900 transition-colors duration-300",children:[e.jsx(Y,{title:"Data Mahasiswa"}),e.jsx(Z,{sidebarOpen:j,setSidebarOpen:L,activeMenu:"mahasiswa"}),e.jsxs("div",{className:`p-4 transition-all duration-300 ${j?"lg:ml-64":"lg:ml-0"}`,children:[e.jsx(D,{sidebarOpen:j,setSidebarOpen:L,darkMode:t,setDarkMode:H,title:"Data Mahasiswa",subtitle:"Kelola data mahasiswa"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-wrap gap-3 justify-end",children:[e.jsxs("button",{onClick:()=>v(!0),className:"inline-flex items-center px-5 py-2.5 border border-transparent rounded-xl shadow-lg text-sm font-semibold text-white bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 transform hover:scale-105 transition-all duration-200",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),"Import Excel"]}),e.jsxs("button",{onClick:O,className:"inline-flex items-center px-5 py-2.5 border border-transparent rounded-xl shadow-lg text-sm font-semibold text-white bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 transform hover:scale-105 transition-all duration-200",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Tambah Mahasiswa"]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 shadow-xl rounded-2xl p-6 border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("svg",{className:"w-5 h-5 text-blue-600 dark:text-blue-400 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z",clipRule:"evenodd"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Pencarian & Filter"})]}),e.jsxs("form",{onSubmit:K,className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 md:gap-4",children:[e.jsx("div",{children:e.jsx("input",{type:"text",placeholder:"Cari NIM atau Nama...",value:E,onChange:a=>R(a.target.value),className:"w-full px-4 py-3 text-base border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-lg shadow-sm focus:border-blue-500 focus:ring-blue-500"})}),e.jsx("div",{children:e.jsxs("select",{value:P,onChange:a=>B(a.target.value),className:"w-full px-4 py-3 text-base border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-lg shadow-sm focus:border-blue-500 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Semua Prodi"}),n.map(a=>e.jsxs("option",{value:a.id,children:[a.nama_prodi," -"," ",a.fakultas?.nama_fakultas]},a.id))]})}),e.jsx("div",{children:e.jsxs("button",{type:"submit",className:"w-full inline-flex items-center justify-center bg-blue-600 hover:bg-blue-700 dark:bg-blue-700 dark:hover:bg-blue-800 text-white px-4 py-3 text-base font-semibold rounded-lg transition-colors",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),"Cari"]})})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 shadow-xl rounded-2xl overflow-hidden border border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"NIM"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Nama"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Prodi"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Kelas"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Angkatan"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Jenis Kelamin"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Aksi"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:l.data.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-6 py-4 text-center text-gray-500 dark:text-gray-400",children:"Tidak ada data mahasiswa"})}):l.data.map(a=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white",children:a.nim}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:a.nama}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:a.prodi?.nama_prodi}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:a.kelas?e.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",children:a.kelas.nama_kelas}):"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:a.angkatan}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:a.jenis_kelamin==="L"?"Laki-laki":"Perempuan"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>J(a),className:"inline-flex items-center justify-center p-2 rounded-lg bg-gradient-to-r from-blue-500 to-indigo-600 text-white hover:from-blue-600 hover:to-indigo-700 transform hover:scale-110 transition-all duration-200 shadow-md hover:shadow-lg",title:"Edit",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),e.jsx("button",{onClick:()=>U(a),className:"inline-flex items-center justify-center p-2 rounded-lg bg-gradient-to-r from-red-500 to-pink-600 text-white hover:from-red-600 hover:to-pink-700 transform hover:scale-110 transition-all duration-200 shadow-md hover:shadow-lg",title:"Hapus",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})})]},a.id))})]})}),l.links.length>3&&e.jsx("div",{className:"bg-white dark:bg-gray-800 px-4 py-3 border-t border-gray-200 dark:border-gray-700 sm:px-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4",children:[e.jsxs("div",{className:"text-sm text-gray-700 dark:text-gray-300",children:["Menampilkan ",l.from," -"," ",l.to," dari"," ",l.total," data"]}),e.jsx("div",{className:"flex gap-2",children:l.links.map((a,w)=>{const y=a.url?"a":"span";return e.jsx(y,{href:a.url||void 0,className:`px-3 py-1 rounded ${a.active?"bg-blue-600 text-white":"bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-600 border dark:border-gray-600"} ${!a.url&&"cursor-not-allowed opacity-50"}`,dangerouslySetInnerHTML:{__html:a.label}},w)})})]})})]})]})]})]}),e.jsx(ee,{show:$,onClose:()=>{v(!1),S(null)},onSubmit:Q,file:N,setFile:S,templateUrl:"/admin/mahasiswa/template/download",entityName:"Mahasiswa"}),e.jsx(A,{show:F,onClose:()=>C(!1),onSubmit:V,formData:f,setFormData:p,prodis:n,kelas:x,loading:T,isEdit:!1}),e.jsx(A,{show:q,onClose:()=>M(!1),onSubmit:G,formData:f,setFormData:p,prodis:n,kelas:x,loading:T,isEdit:!0}),e.jsx(ae,{show:z,onClose:()=>{_(!1),h(null)},onConfirm:W,title:"Hapus Data Mahasiswa",message:"Apakah Anda yakin ingin menghapus data mahasiswa",itemName:g?`${g.nama} (${g.nim})`:""}),u&&e.jsx(te,{type:c.type,message:c.message,details:c.details,onClose:()=>{console.log("Toast onClose called"),o(!1)},duration:c.details?.length>0?8e3:5e3})]})}export{oe as default};
