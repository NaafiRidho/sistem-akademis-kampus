import{a as t,j as e,u as O,H as Z,b as f}from"./app-DRMUs7Ql.js";import{S as V}from"./Sidebar-BEbXwXvu.js";import{H as K}from"./Header-CGQiYpCt.js";import{u as G,I as J}from"./ImportModal-CU3mRlja.js";import{D as Q}from"./DeleteConfirmationModal-LoH6LA-l.js";import{T as X}from"./Toast-Dy97WA_D.js";/* empty css            */function T({show:s,onClose:y,onSubmit:j,formData:g,prodis:i,isEdit:n=!1}){const{register:r,handleSubmit:c,formState:{errors:o},reset:d}=G({defaultValues:g});if(t.useEffect(()=>{s&&d(g)},[s,g,d]),!s)return null;const v=l=>{const b={preventDefault:()=>{}};Object.assign(g,l),j(b)};return e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50 flex items-start justify-center p-4",children:e.jsxs("div",{className:"relative top-4 md:top-10 mx-auto p-4 md:p-5 border w-full max-w-2xl shadow-lg rounded-md bg-white dark:bg-gray-800",children:[e.jsx("h3",{className:"text-lg font-medium leading-6 text-gray-900 dark:text-white mb-4",children:n?"Edit Data Dosen":"Tambah Data Dosen"}),e.jsxs("form",{onSubmit:c(v),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"NIDN *"}),e.jsx("input",{type:"text",...r("nidn",{required:"NIDN wajib diisi"}),className:"w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm"}),o.nidn&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:o.nidn.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Nama *"}),e.jsx("input",{type:"text",...r("nama",{required:"Nama wajib diisi"}),className:"w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm"}),o.nama&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:o.nama.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Email *"}),e.jsx("input",{type:"email",...r("email",{required:"Email wajib diisi",pattern:{value:/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i,message:"Format email tidak valid"}}),className:"w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm"}),o.email&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:o.email.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"No. Telepon"}),e.jsx("input",{type:"text",...r("no_telepon"),className:"w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm",placeholder:"08xxxxxxxxxx"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Pendidikan Terakhir"}),e.jsxs("select",{...r("pendidikan_terakhir"),className:"w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm",children:[e.jsx("option",{value:"",children:"Pilih Pendidikan"}),e.jsx("option",{value:"S1",children:"S1"}),e.jsx("option",{value:"S2",children:"S2"}),e.jsx("option",{value:"S3",children:"S3"}),e.jsx("option",{value:"Profesor",children:"Profesor"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Program Studi Mengajar"}),e.jsxs("select",{...r("prodi_id"),className:"w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm",children:[e.jsx("option",{value:"",children:"Pilih Prodi"}),i?.map(l=>e.jsxs("option",{value:l.id,children:[l.nama_prodi," - ",l.fakultas?.nama_fakultas]},l.id))]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Password ",n&&"(kosongkan jika tidak diubah)",!n&&" *"]}),e.jsx("input",{type:"password",...r("password",{required:n?!1:"Password wajib diisi",minLength:{value:6,message:"Password minimal 6 karakter"}}),className:"w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm"}),o.password&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:o.password.message})]})]}),e.jsxs("div",{className:"flex gap-2 mt-6",children:[e.jsx("button",{type:"submit",className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700",children:n?"Update":"Simpan"}),e.jsx("button",{type:"button",onClick:y,className:"flex-1 bg-gray-300 dark:bg-gray-600 text-gray-700 dark:text-gray-300 px-4 py-2 rounded-md hover:bg-gray-400 dark:hover:bg-gray-500",children:"Batal"})]})]})]})})}function le({dosen:s,prodis:y,filters:j}){const i=O().props;i.flash;const[n,r]=t.useState(!1),[c,o]=t.useState({type:"info",message:"",details:[]}),[d,v]=t.useState(()=>{if(typeof window<"u"){const a=localStorage.getItem("darkMode");return a!==null?a==="true":window.matchMedia("(prefers-color-scheme: dark)").matches}return!1}),[l,b]=t.useState(()=>typeof window<"u"?window.innerWidth>=1024:!0),[_,I]=t.useState(j.search||""),[L,N]=t.useState(!1),[m,S]=t.useState(null),[P,D]=t.useState(!1),[F,C]=t.useState(!1),[H,M]=t.useState(!1),[x,h]=t.useState(null),[k,p]=t.useState({nidn:"",nama:"",email:"",password:"",no_telepon:"",pendidikan_terakhir:"",prodi_id:""});t.useEffect(()=>{d?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),localStorage.setItem("darkMode",String(d))},[d]),t.useEffect(()=>{console.log("=== Dosen Flash Effect Triggered ==="),console.log("Props in effect:",i),console.log("Flash in effect:",i?.flash);const a=i?.flash;r(!1),setTimeout(()=>{a?.success?(console.log("Setting SUCCESS toast with message:",a.success),o({type:"success",message:a.success,details:a.import_errors||[]}),r(!0),console.log("Toast state set to TRUE")):a?.error&&(console.log("Setting ERROR toast with message:",a.error),o({type:"error",message:a.error,details:a.import_errors||[]}),r(!0),console.log("Toast state set to TRUE"))},100)},[i]);const E=()=>({nidn:"",nama:"",email:"",password:"",no_telepon:"",pendidikan_terakhir:"",prodi_id:""}),A=a=>{a.preventDefault(),f.get("/admin/dosen",{search:_},{preserveState:!0,replace:!0})},R=a=>{h(a),M(!0)},$=()=>{x&&f.post(`/admin/dosen/${x?.id}`,{_method:"DELETE"},{onSuccess:()=>{M(!1),h(null)}})},B=()=>{p(E()),D(!0)},U=a=>{h(a),p({nidn:a.nidn,nama:a.nama,email:a.user?.email||a.email||"",password:"",no_telepon:a.no_telepon||"",pendidikan_terakhir:a.pendidikan_terakhir||"",prodi_id:a.prodi_id?.toString()||""}),C(!0)},W=a=>{a.preventDefault(),f.post("/admin/dosen",k,{onSuccess:()=>{D(!1),p(E())}})},z=a=>{a.preventDefault(),f.post(`/admin/dosen/${x?.id}`,{...k,_method:"PUT"},{onSuccess:()=>{C(!1),h(null)}})},q=a=>{if(a.preventDefault(),!m){alert("Silakan pilih file terlebih dahulu");return}console.log("Importing file:",m),console.log("File type:",m.type),console.log("File name:",m.name);const w=new FormData;w.append("file",m,m.name),console.log("FormData created, posting to server..."),f.post("/admin/dosen/import",w,{forceFormData:!0,preserveState:!1,preserveScroll:!1,onSuccess:u=>{console.log("Import success:",u.props.flash),N(!1),S(null)},onError:u=>{console.log("Import errors:",u)}})};return e.jsxs("div",{className:d?"dark":"",children:[e.jsxs("div",{className:"min-h-screen bg-gray-100 dark:bg-gray-900 transition-colors duration-300",children:[e.jsx(Z,{title:"Data Dosen"}),e.jsx(V,{sidebarOpen:l,setSidebarOpen:b,activeMenu:"dosen"}),e.jsxs("div",{className:`p-4 transition-all duration-300 ${l?"lg:ml-64":"lg:ml-0"}`,children:[e.jsx(K,{sidebarOpen:l,setSidebarOpen:b,darkMode:d,setDarkMode:v,title:"Data Dosen",subtitle:"Kelola data dosen"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-wrap gap-3 justify-end",children:[e.jsxs("button",{onClick:()=>N(!0),className:"inline-flex items-center px-5 py-2.5 border border-transparent rounded-xl shadow-lg text-sm font-semibold text-white bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 transform hover:scale-105 transition-all duration-200",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),"Import Excel"]}),e.jsxs("button",{onClick:B,className:"inline-flex items-center px-5 py-2.5 border border-transparent rounded-xl shadow-lg text-sm font-semibold text-white bg-gradient-to-r from-indigo-500 to-purple-600 hover:from-indigo-600 hover:to-purple-700 transform hover:scale-105 transition-all duration-200",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Tambah Dosen"]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 shadow-xl rounded-2xl p-6 border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("svg",{className:"w-5 h-5 text-indigo-600 dark:text-indigo-400 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z",clipRule:"evenodd"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Pencarian Data"})]}),e.jsxs("form",{onSubmit:A,className:"flex gap-3",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",placeholder:"Cari NIDN atau Nama...",value:_,onChange:a=>I(a.target.value),className:"w-full px-4 py-3 text-base border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-lg shadow-sm focus:border-blue-500 focus:ring-blue-500"})}),e.jsx("div",{children:e.jsxs("button",{type:"submit",className:"inline-flex items-center justify-center bg-blue-600 hover:bg-blue-700 dark:bg-blue-700 dark:hover:bg-blue-800 text-white px-6 py-3 text-base font-semibold rounded-lg transition-colors",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),"Cari"]})})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 shadow-xl rounded-2xl overflow-hidden border border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"NIDN"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Nama"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Email"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"No. Telepon"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Pendidikan"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Prodi Mengajar"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Aksi"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:s.data.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-6 py-4 text-center text-gray-500 dark:text-gray-400",children:"Tidak ada data dosen"})}):s.data.map(a=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white",children:a.nidn}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:a.nama}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:a.email}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:a.no_telepon||"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:a.pendidikan_terakhir||"-"}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-500 dark:text-gray-300",children:a.prodi?a.prodi.nama_prodi:"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>U(a),className:"inline-flex items-center justify-center p-2 rounded-lg bg-gradient-to-r from-blue-500 to-indigo-600 text-white hover:from-blue-600 hover:to-indigo-700 transform hover:scale-110 transition-all duration-200 shadow-md hover:shadow-lg",title:"Edit",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),e.jsx("button",{onClick:()=>R(a),className:"inline-flex items-center justify-center p-2 rounded-lg bg-gradient-to-r from-red-500 to-pink-600 text-white hover:from-red-600 hover:to-pink-700 transform hover:scale-110 transition-all duration-200 shadow-md hover:shadow-lg",title:"Hapus",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})})]},a.id))})]})}),s.links.length>3&&e.jsx("div",{className:"bg-white dark:bg-gray-800 px-4 py-3 border-t border-gray-200 dark:border-gray-700 sm:px-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4",children:[e.jsxs("div",{className:"text-sm text-gray-700 dark:text-gray-300",children:["Menampilkan ",s.from," - ",s.to," dari ",s.total," data"]}),e.jsx("div",{className:"flex gap-2",children:s.links.map((a,w)=>{const u=a.url?"a":"span";return e.jsx(u,{href:a.url||void 0,className:`px-3 py-1 rounded ${a.active?"bg-blue-600 text-white":"bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-600 border dark:border-gray-600"} ${!a.url&&"cursor-not-allowed opacity-50"}`,dangerouslySetInnerHTML:{__html:a.label}},w)})})]})})]})]})]})]}),e.jsx(J,{show:L,onClose:()=>{N(!1),S(null)},onSubmit:q,file:m,setFile:S,templateUrl:"/admin/dosen/template/download",entityName:"Dosen"}),e.jsx(T,{show:P,onClose:()=>D(!1),onSubmit:W,formData:k,setFormData:p,prodis:y,isEdit:!1}),e.jsx(T,{show:F,onClose:()=>C(!1),onSubmit:z,formData:k,setFormData:p,prodis:y,isEdit:!0}),e.jsx(Q,{show:H,onClose:()=>{M(!1),h(null)},onConfirm:$,title:"Hapus Data Dosen",message:"Apakah Anda yakin ingin menghapus data dosen",itemName:x?`${x.nama} (${x.nidn})`:""}),n&&e.jsx(X,{type:c.type,message:c.message,details:c.details,onClose:()=>{console.log("Toast onClose called"),r(!1)},duration:c.details?.length>0?8e3:5e3})]})}export{le as default};
