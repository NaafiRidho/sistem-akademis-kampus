import{a as r,j as e,u as G,H as Q,b as y}from"./app-DRMUs7Ql.js";import{S as X}from"./Sidebar-BEbXwXvu.js";import{H as Y}from"./Header-CGQiYpCt.js";import{u as ee,I as ae}from"./ImportModal-CU3mRlja.js";import{L as te}from"./LoadingButton-D-k5dC3u.js";import{D as re}from"./DeleteConfirmationModal-LoH6LA-l.js";import{T as se}from"./Toast-Dy97WA_D.js";/* empty css            */function H({show:i,onClose:h,onSubmit:w,formData:x,prodis:P,kelas:g,isEdit:n=!1,loading:c=!1}){const{register:d,handleSubmit:j,formState:{errors:t},reset:v,watch:p,setValue:k}=ee({defaultValues:x});r.useEffect(()=>{i&&v(x)},[i,x,v]);const l=p("prodi_id");r.useEffect(()=>{},[i,g,l]);const o=l?(g||[]).filter(s=>s.prodi_id==parseInt(l)||s.prodi_id===parseInt(l)):g||[];if(r.useEffect(()=>{k("kelas_id","")},[l,k]),!i)return null;const N=s=>{w(s)};return e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50 flex items-start justify-center p-4",children:e.jsxs("div",{className:"relative top-4 md:top-10 mx-auto p-4 md:p-5 border w-full max-w-2xl shadow-lg rounded-md bg-white dark:bg-gray-800",children:[e.jsx("h3",{className:"text-lg font-medium leading-6 text-gray-900 dark:text-white mb-4",children:n?"Edit Data Mahasiswa":"Tambah Data Mahasiswa"}),e.jsxs("form",{onSubmit:j(N),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"NIM *"}),e.jsx("input",{type:"text",...d("nim",{required:"NIM wajib diisi"}),className:"w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm"}),t.nim&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:t.nim.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Nama *"}),e.jsx("input",{type:"text",...d("nama",{required:"Nama wajib diisi"}),className:"w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm"}),t.nama&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:t.nama.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Prodi *"}),e.jsxs("select",{...d("prodi_id",{required:"Prodi wajib dipilih"}),className:"w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm",children:[e.jsx("option",{value:"",children:"Pilih Prodi"}),P.map(s=>e.jsxs("option",{value:s.id,children:[s.nama_prodi," - ",s.fakultas?.nama_fakultas]},s.id))]}),t.prodi_id&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:t.prodi_id.message})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Kelas",l&&o&&o.length>0&&e.jsxs("span",{className:"ml-2 text-xs text-gray-500 dark:text-gray-400",children:["(",o.length," kelas tersedia)"]})]}),e.jsxs("select",{...d("kelas_id"),className:"w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm",disabled:!l,children:[e.jsx("option",{value:"",children:l?"Pilih Kelas":"Pilih Prodi Terlebih Dahulu"}),o?.map(s=>e.jsxs("option",{value:s.id,children:[s.nama_kelas," - Semester ",s.semester]},s.id))]}),l&&(!o||o.length===0)&&e.jsx("p",{className:"mt-1 text-sm text-amber-600 dark:text-amber-400",children:"⚠️ Tidak ada kelas untuk prodi ini"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Angkatan *"}),e.jsx("input",{type:"number",...d("angkatan",{required:"Angkatan wajib diisi",min:{value:2e3,message:"Angkatan minimal 2000"}}),className:"w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm"}),t.angkatan&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:t.angkatan.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Jenis Kelamin *"}),e.jsxs("select",{...d("jenis_kelamin",{required:"Jenis kelamin wajib dipilih"}),className:"w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm",children:[e.jsx("option",{value:"L",children:"Laki-laki"}),e.jsx("option",{value:"P",children:"Perempuan"})]}),t.jenis_kelamin&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:t.jenis_kelamin.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Email *"}),e.jsx("input",{type:"email",...d("email",{required:"Email wajib diisi",pattern:{value:/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i,message:"Format email tidak valid"}}),className:"w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm"}),t.email&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:t.email.message})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Password ",n&&"(kosongkan jika tidak diubah)",!n&&" *"]}),e.jsx("input",{type:"password",...d("password",{required:n?!1:"Password wajib diisi",minLength:{value:6,message:"Password minimal 6 karakter"}}),className:"w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm"}),t.password&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:t.password.message})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Alamat"}),e.jsx("textarea",{rows:3,...d("alamat"),className:"w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm"})]})]}),e.jsxs("div",{className:"flex gap-2 mt-6",children:[e.jsx(te,{type:"submit",loading:c,className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 disabled:opacity-50",children:n?"Update":"Simpan"}),e.jsx("button",{type:"button",onClick:h,disabled:c,className:"flex-1 bg-gray-300 dark:bg-gray-600 text-gray-700 dark:text-gray-300 px-4 py-2 rounded-md hover:bg-gray-400 dark:hover:bg-gray-500 disabled:opacity-50",children:"Batal"})]})]})]})})}function ge({mahasiswa:i,prodis:h,kelas:w,filters:x}){const g=G().props,[n,c]=r.useState(!1),[d,j]=r.useState({type:"info",message:"",details:[]}),[t,v]=r.useState(()=>{if(typeof window<"u"){const a=localStorage.getItem("darkMode");return a!==null?a==="true":window.matchMedia("(prefers-color-scheme: dark)").matches}return!1}),[p,k]=r.useState(()=>typeof window<"u"?window.innerWidth>=1024:!0),[l,o]=r.useState(x.search||""),[N,s]=r.useState(x.prodi_id||""),[B,M]=r.useState(!1),[_,C]=r.useState(null),[$,L]=r.useState(!1),[q,E]=r.useState(!1),[K,I]=r.useState(!1),[u,b]=r.useState(null),[T,m]=r.useState(!1),[F,D]=r.useState({nim:"",nama:"",prodi_id:"",kelas_id:"",angkatan:"",jenis_kelamin:"L",alamat:"",email:"",password:""});r.useEffect(()=>{t?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),localStorage.setItem("darkMode",String(t))},[t]),r.useEffect(()=>{const a=g?.flash;c(!1),setTimeout(()=>{a?.success?(j({type:"success",message:a.success,details:a.import_errors||[]}),c(!0)):a?.error&&(j({type:"error",message:a.error,details:a.import_errors||[]}),c(!0))},100)},[g]);const A=()=>({nim:"",nama:"",prodi_id:"",kelas_id:"",angkatan:"",jenis_kelamin:"L",alamat:"",email:"",password:""}),W=a=>{a.preventDefault(),y.get("/admin/mahasiswa",{search:l,prodi_id:N},{preserveState:!0,replace:!0})},z=a=>{b(a),I(!0)},R=()=>{u&&y.post(`/admin/mahasiswa/${u?.id}`,{_method:"DELETE"},{onSuccess:()=>{I(!1),b(null)}})},J=()=>{D(A()),L(!0)},U=a=>{b(a),D({nim:a.nim,nama:a.nama,prodi_id:String(a.prodi_id),kelas_id:a.kelas_id?String(a.kelas_id):"",angkatan:String(a.angkatan),jenis_kelamin:a.jenis_kelamin,alamat:a.alamat||"",email:a.user?.email||"",password:""}),E(!0)},V=a=>{m(!0),y.post("/admin/mahasiswa",a,{onSuccess:()=>{L(!1),D(A()),m(!1)},onError:()=>{m(!1)},onFinish:()=>{m(!1)}})},Z=a=>{m(!0),y.post(`/admin/mahasiswa/${u?.id}`,{...a,_method:"PUT"},{onSuccess:()=>{E(!1),b(null),m(!1)},onError:()=>{m(!1)},onFinish:()=>{m(!1)}})},O=a=>{if(a.preventDefault(),!_){alert("Silakan pilih file terlebih dahulu");return}const S=new FormData;S.append("file",_),y.post("/admin/mahasiswa/import",S,{onSuccess:f=>{console.log("Import success:",f.props.flash),M(!1),C(null)},onError:f=>{console.log("Import errors:",f)}})};return console.log("Rendering toast check - showToast:",n,"toastConfig:",d),e.jsxs("div",{className:t?"dark":"",children:[e.jsxs("div",{className:"min-h-screen bg-gray-100 dark:bg-gray-900 transition-colors duration-300",children:[e.jsx(Q,{title:"Data Mahasiswa"}),e.jsx(X,{sidebarOpen:p,setSidebarOpen:k,activeMenu:"mahasiswa"}),e.jsxs("div",{className:`p-4 transition-all duration-300 ${p?"lg:ml-64":"lg:ml-0"}`,children:[e.jsx(Y,{sidebarOpen:p,setSidebarOpen:k,darkMode:t,setDarkMode:v,title:"Data Mahasiswa",subtitle:"Kelola data mahasiswa"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-wrap gap-3 justify-end",children:[e.jsxs("button",{onClick:()=>M(!0),className:"inline-flex items-center px-5 py-2.5 border border-transparent rounded-xl shadow-lg text-sm font-semibold text-white bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 transform hover:scale-105 transition-all duration-200",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),"Import Excel"]}),e.jsxs("button",{onClick:J,className:"inline-flex items-center px-5 py-2.5 border border-transparent rounded-xl shadow-lg text-sm font-semibold text-white bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 transform hover:scale-105 transition-all duration-200",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Tambah Mahasiswa"]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 shadow-xl rounded-2xl p-6 border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("svg",{className:"w-5 h-5 text-blue-600 dark:text-blue-400 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z",clipRule:"evenodd"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Pencarian & Filter"})]}),e.jsxs("form",{onSubmit:W,className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 md:gap-4",children:[e.jsx("div",{children:e.jsx("input",{type:"text",placeholder:"Cari NIM atau Nama...",value:l,onChange:a=>o(a.target.value),className:"w-full px-4 py-3 text-base border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-lg shadow-sm focus:border-blue-500 focus:ring-blue-500"})}),e.jsx("div",{children:e.jsxs("select",{value:N,onChange:a=>s(a.target.value),className:"w-full px-4 py-3 text-base border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-lg shadow-sm focus:border-blue-500 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Semua Prodi"}),h.map(a=>e.jsxs("option",{value:a.id,children:[a.nama_prodi," -"," ",a.fakultas?.nama_fakultas]},a.id))]})}),e.jsx("div",{children:e.jsxs("button",{type:"submit",className:"w-full inline-flex items-center justify-center bg-blue-600 hover:bg-blue-700 dark:bg-blue-700 dark:hover:bg-blue-800 text-white px-4 py-3 text-base font-semibold rounded-lg transition-colors",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),"Cari"]})})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 shadow-xl rounded-2xl overflow-hidden border border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"NIM"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Nama"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Prodi"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Kelas"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Angkatan"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Jenis Kelamin"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Aksi"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:i.data.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-6 py-4 text-center text-gray-500 dark:text-gray-400",children:"Tidak ada data mahasiswa"})}):i.data.map(a=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white",children:a.nim}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:a.nama}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:a.prodi?.nama_prodi}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:a.kelas?e.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",children:a.kelas.nama_kelas}):"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:a.angkatan}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:a.jenis_kelamin==="L"?"Laki-laki":"Perempuan"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>U(a),className:"inline-flex items-center justify-center p-2 rounded-lg bg-gradient-to-r from-blue-500 to-indigo-600 text-white hover:from-blue-600 hover:to-indigo-700 transform hover:scale-110 transition-all duration-200 shadow-md hover:shadow-lg",title:"Edit",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),e.jsx("button",{onClick:()=>z(a),className:"inline-flex items-center justify-center p-2 rounded-lg bg-gradient-to-r from-red-500 to-pink-600 text-white hover:from-red-600 hover:to-pink-700 transform hover:scale-110 transition-all duration-200 shadow-md hover:shadow-lg",title:"Hapus",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})})]},a.id))})]})}),i.links.length>3&&e.jsx("div",{className:"bg-white dark:bg-gray-800 px-4 py-3 border-t border-gray-200 dark:border-gray-700 sm:px-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4",children:[e.jsxs("div",{className:"text-sm text-gray-700 dark:text-gray-300",children:["Menampilkan ",i.from," -"," ",i.to," dari"," ",i.total," data"]}),e.jsx("div",{className:"flex gap-2",children:i.links.map((a,S)=>{const f=a.url?"a":"span";return e.jsx(f,{href:a.url||void 0,className:`px-3 py-1 rounded ${a.active?"bg-blue-600 text-white":"bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-600 border dark:border-gray-600"} ${!a.url&&"cursor-not-allowed opacity-50"}`,dangerouslySetInnerHTML:{__html:a.label}},S)})})]})})]})]})]})]}),e.jsx(ae,{show:B,onClose:()=>{M(!1),C(null)},onSubmit:O,file:_,setFile:C,templateUrl:"/admin/mahasiswa/template/download",entityName:"Mahasiswa"}),e.jsx(H,{show:$,onClose:()=>L(!1),onSubmit:V,formData:F,prodis:h,kelas:w,loading:T,isEdit:!1}),e.jsx(H,{show:q,onClose:()=>E(!1),onSubmit:Z,formData:F,prodis:h,kelas:w,loading:T,isEdit:!0}),e.jsx(re,{show:K,onClose:()=>{I(!1),b(null)},onConfirm:R,title:"Hapus Data Mahasiswa",message:"Apakah Anda yakin ingin menghapus data mahasiswa",itemName:u?`${u.nama} (${u.nim})`:""}),n&&e.jsx(se,{type:d.type,message:d.message,details:d.details,onClose:()=>{console.log("Toast onClose called"),c(!1)},duration:d.details?.length>0?8e3:5e3})]})}export{ge as default};
