import{j as e,a as s,u as G,H as Q,b as y}from"./app-CQBC_FSQ.js";import{S as X,H as Y}from"./Header-Mur1alXs.js";import{u as ee}from"./index.esm-BLcWMkOJ.js";import{I as ae,D as te,T as se}from"./Toast-Dz27-0Fs.js";/* empty css            */function re({loading:r=!1,disabled:o=!1,children:u,className:n="",type:w="button",onClick:i}){return e.jsxs("button",{type:w,onClick:i,disabled:o||r,className:`relative inline-flex items-center justify-center ${n} ${o||r?"opacity-70 cursor-not-allowed":""}`,children:[r&&e.jsx("div",{className:"absolute left-4",children:e.jsxs("svg",{className:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}),e.jsx("span",{className:r?"ml-6":"",children:u})]})}function H({show:r,onClose:o,onSubmit:u,formData:n,prodis:w,kelas:i,isEdit:m=!1,loading:x=!1}){const{register:l,handleSubmit:j,formState:{errors:t},reset:v,watch:p,setValue:f}=ee({defaultValues:n});s.useEffect(()=>{r&&v(n)},[r,n,v]);const g=p("prodi_id"),M=g?i?.filter(d=>d.prodi_id===parseInt(g)):i;if(s.useEffect(()=>{f("kelas_id","")},[g,f]),!r)return null;const N=d=>{u(d)};return e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50 flex items-start justify-center p-4",children:e.jsxs("div",{className:"relative top-4 md:top-10 mx-auto p-4 md:p-5 border w-full max-w-2xl shadow-lg rounded-md bg-white dark:bg-gray-800",children:[e.jsx("h3",{className:"text-lg font-medium leading-6 text-gray-900 dark:text-white mb-4",children:m?"Edit Data Mahasiswa":"Tambah Data Mahasiswa"}),e.jsxs("form",{onSubmit:j(N),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"NIM *"}),e.jsx("input",{type:"text",...l("nim",{required:"NIM wajib diisi"}),className:"w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm"}),t.nim&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:t.nim.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Nama *"}),e.jsx("input",{type:"text",...l("nama",{required:"Nama wajib diisi"}),className:"w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm"}),t.nama&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:t.nama.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Prodi *"}),e.jsxs("select",{...l("prodi_id",{required:"Prodi wajib dipilih"}),className:"w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm",children:[e.jsx("option",{value:"",children:"Pilih Prodi"}),w.map(d=>e.jsxs("option",{value:d.id,children:[d.nama_prodi," - ",d.fakultas?.nama_fakultas]},d.id))]}),t.prodi_id&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:t.prodi_id.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Kelas"}),e.jsxs("select",{...l("kelas_id"),className:"w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm",disabled:!g,children:[e.jsx("option",{value:"",children:"Pilih Kelas"}),M?.map(d=>e.jsxs("option",{value:d.id,children:[d.nama_kelas," - Semester ",d.semester]},d.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Angkatan *"}),e.jsx("input",{type:"number",...l("angkatan",{required:"Angkatan wajib diisi",min:{value:2e3,message:"Angkatan minimal 2000"}}),className:"w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm"}),t.angkatan&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:t.angkatan.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Jenis Kelamin *"}),e.jsxs("select",{...l("jenis_kelamin",{required:"Jenis kelamin wajib dipilih"}),className:"w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm",children:[e.jsx("option",{value:"L",children:"Laki-laki"}),e.jsx("option",{value:"P",children:"Perempuan"})]}),t.jenis_kelamin&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:t.jenis_kelamin.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Email *"}),e.jsx("input",{type:"email",...l("email",{required:"Email wajib diisi",pattern:{value:/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i,message:"Format email tidak valid"}}),className:"w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm"}),t.email&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:t.email.message})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Password ",m&&"(kosongkan jika tidak diubah)",!m&&" *"]}),e.jsx("input",{type:"password",...l("password",{required:m?!1:"Password wajib diisi",minLength:{value:6,message:"Password minimal 6 karakter"}}),className:"w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm"}),t.password&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:t.password.message})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Alamat"}),e.jsx("textarea",{rows:3,...l("alamat"),className:"w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm"})]})]}),e.jsxs("div",{className:"flex gap-2 mt-6",children:[e.jsx(re,{type:"submit",loading:x,className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 disabled:opacity-50",children:m?"Update":"Simpan"}),e.jsx("button",{type:"button",onClick:o,disabled:x,className:"flex-1 bg-gray-300 dark:bg-gray-600 text-gray-700 dark:text-gray-300 px-4 py-2 rounded-md hover:bg-gray-400 dark:hover:bg-gray-500 disabled:opacity-50",children:"Batal"})]})]})]})})}function me({mahasiswa:r,prodis:o,kelas:u,filters:n}){const i=G().props,[m,x]=s.useState(!1),[l,j]=s.useState({type:"info",message:"",details:[]});console.log("=== FULL PAGE PROPS ===",i),console.log("Props keys:",Object.keys(i)),console.log("Auth:",i.auth),console.log("Flash:",i.flash),console.log("Errors:",i.errors);const[t,v]=s.useState(()=>{if(typeof window<"u"){const a=localStorage.getItem("darkMode");return a!==null?a==="true":window.matchMedia("(prefers-color-scheme: dark)").matches}return!1}),[p,f]=s.useState(()=>typeof window<"u"?window.innerWidth>=1024:!0),[g,M]=s.useState(n.search||""),[N,d]=s.useState(n.prodi_id||""),[R,_]=s.useState(!1),[C,E]=s.useState(null),[$,L]=s.useState(!1),[B,P]=s.useState(!1),[q,F]=s.useState(!1),[h,k]=s.useState(null),[T,c]=s.useState(!1),[D,I]=s.useState({nim:"",nama:"",prodi_id:"",kelas_id:"",angkatan:"",jenis_kelamin:"L",alamat:"",email:"",password:""});s.useEffect(()=>{t?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),localStorage.setItem("darkMode",String(t))},[t]),s.useEffect(()=>{console.log("=== Flash Effect Triggered ==="),console.log("Props in effect:",i),console.log("Flash in effect:",i?.flash);const a=i?.flash;x(!1),setTimeout(()=>{a?.success?(console.log("Setting SUCCESS toast with message:",a.success),j({type:"success",message:a.success,details:a.import_errors||[]}),x(!0),console.log("Toast state set to TRUE")):a?.error&&(console.log("Setting ERROR toast with message:",a.error),j({type:"error",message:a.error,details:a.import_errors||[]}),x(!0),console.log("Toast state set to TRUE"))},100)},[i]);const A=()=>({nim:"",nama:"",prodi_id:"",kelas_id:"",angkatan:"",jenis_kelamin:"L",alamat:"",email:"",password:""}),z=a=>{a.preventDefault(),y.get("/admin/mahasiswa",{search:g,prodi_id:N},{preserveState:!0,replace:!0})},K=a=>{k(a),F(!0)},U=()=>{h&&y.post(`/admin/mahasiswa/${h?.id}`,{_method:"DELETE"},{onSuccess:()=>{F(!1),k(null)}})},W=()=>{I(A()),L(!0)},O=a=>{k(a),I({nim:a.nim,nama:a.nama,prodi_id:String(a.prodi_id),kelas_id:a.kelas_id?String(a.kelas_id):"",angkatan:String(a.angkatan),jenis_kelamin:a.jenis_kelamin,alamat:a.alamat||"",email:a.user?.email||"",password:""}),P(!0)},V=a=>{c(!0),y.post("/admin/mahasiswa",a,{onSuccess:()=>{L(!1),I(A()),c(!1)},onError:()=>{c(!1)},onFinish:()=>{c(!1)}})},J=a=>{c(!0),y.post(`/admin/mahasiswa/${h?.id}`,{...a,_method:"PUT"},{onSuccess:()=>{P(!1),k(null),c(!1)},onError:()=>{c(!1)},onFinish:()=>{c(!1)}})},Z=a=>{if(a.preventDefault(),!C){alert("Silakan pilih file terlebih dahulu");return}const S=new FormData;S.append("file",C),y.post("/admin/mahasiswa/import",S,{onSuccess:b=>{console.log("Import success:",b.props.flash),_(!1),E(null)},onError:b=>{console.log("Import errors:",b)}})};return console.log("Rendering toast check - showToast:",m,"toastConfig:",l),e.jsxs("div",{className:t?"dark":"",children:[e.jsxs("div",{className:"min-h-screen bg-gray-100 dark:bg-gray-900 transition-colors duration-300",children:[e.jsx(Q,{title:"Data Mahasiswa"}),e.jsx(X,{sidebarOpen:p,setSidebarOpen:f,activeMenu:"mahasiswa"}),e.jsxs("div",{className:`p-4 transition-all duration-300 ${p?"lg:ml-64":"lg:ml-0"}`,children:[e.jsx(Y,{sidebarOpen:p,setSidebarOpen:f,darkMode:t,setDarkMode:v,title:"Data Mahasiswa",subtitle:"Kelola data mahasiswa"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-wrap gap-3 justify-end",children:[e.jsxs("button",{onClick:()=>_(!0),className:"inline-flex items-center px-5 py-2.5 border border-transparent rounded-xl shadow-lg text-sm font-semibold text-white bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 transform hover:scale-105 transition-all duration-200",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),"Import Excel"]}),e.jsxs("button",{onClick:W,className:"inline-flex items-center px-5 py-2.5 border border-transparent rounded-xl shadow-lg text-sm font-semibold text-white bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 transform hover:scale-105 transition-all duration-200",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Tambah Mahasiswa"]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 shadow-xl rounded-2xl p-6 border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("svg",{className:"w-5 h-5 text-blue-600 dark:text-blue-400 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z",clipRule:"evenodd"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Pencarian & Filter"})]}),e.jsxs("form",{onSubmit:z,className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 md:gap-4",children:[e.jsx("div",{children:e.jsx("input",{type:"text",placeholder:"Cari NIM atau Nama...",value:g,onChange:a=>M(a.target.value),className:"w-full px-4 py-3 text-base border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-lg shadow-sm focus:border-blue-500 focus:ring-blue-500"})}),e.jsx("div",{children:e.jsxs("select",{value:N,onChange:a=>d(a.target.value),className:"w-full px-4 py-3 text-base border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-lg shadow-sm focus:border-blue-500 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Semua Prodi"}),o.map(a=>e.jsxs("option",{value:a.id,children:[a.nama_prodi," -"," ",a.fakultas?.nama_fakultas]},a.id))]})}),e.jsx("div",{children:e.jsxs("button",{type:"submit",className:"w-full inline-flex items-center justify-center bg-blue-600 hover:bg-blue-700 dark:bg-blue-700 dark:hover:bg-blue-800 text-white px-4 py-3 text-base font-semibold rounded-lg transition-colors",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),"Cari"]})})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 shadow-xl rounded-2xl overflow-hidden border border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"NIM"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Nama"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Prodi"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Kelas"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Angkatan"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Jenis Kelamin"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Aksi"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:r.data.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-6 py-4 text-center text-gray-500 dark:text-gray-400",children:"Tidak ada data mahasiswa"})}):r.data.map(a=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white",children:a.nim}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:a.nama}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:a.prodi?.nama_prodi}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:a.kelas?e.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",children:a.kelas.nama_kelas}):"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:a.angkatan}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:a.jenis_kelamin==="L"?"Laki-laki":"Perempuan"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>O(a),className:"inline-flex items-center justify-center p-2 rounded-lg bg-gradient-to-r from-blue-500 to-indigo-600 text-white hover:from-blue-600 hover:to-indigo-700 transform hover:scale-110 transition-all duration-200 shadow-md hover:shadow-lg",title:"Edit",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),e.jsx("button",{onClick:()=>K(a),className:"inline-flex items-center justify-center p-2 rounded-lg bg-gradient-to-r from-red-500 to-pink-600 text-white hover:from-red-600 hover:to-pink-700 transform hover:scale-110 transition-all duration-200 shadow-md hover:shadow-lg",title:"Hapus",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})})]},a.id))})]})}),r.links.length>3&&e.jsx("div",{className:"bg-white dark:bg-gray-800 px-4 py-3 border-t border-gray-200 dark:border-gray-700 sm:px-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4",children:[e.jsxs("div",{className:"text-sm text-gray-700 dark:text-gray-300",children:["Menampilkan ",r.from," -"," ",r.to," dari"," ",r.total," data"]}),e.jsx("div",{className:"flex gap-2",children:r.links.map((a,S)=>{const b=a.url?"a":"span";return e.jsx(b,{href:a.url||void 0,className:`px-3 py-1 rounded ${a.active?"bg-blue-600 text-white":"bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-600 border dark:border-gray-600"} ${!a.url&&"cursor-not-allowed opacity-50"}`,dangerouslySetInnerHTML:{__html:a.label}},S)})})]})})]})]})]})]}),e.jsx(ae,{show:R,onClose:()=>{_(!1),E(null)},onSubmit:Z,file:C,setFile:E,templateUrl:"/admin/mahasiswa/template/download",entityName:"Mahasiswa"}),e.jsx(H,{show:$,onClose:()=>L(!1),onSubmit:V,formData:D,prodis:o,kelas:u,loading:T,isEdit:!1}),e.jsx(H,{show:B,onClose:()=>P(!1),onSubmit:J,formData:D,prodis:o,kelas:u,loading:T,isEdit:!0}),e.jsx(te,{show:q,onClose:()=>{F(!1),k(null)},onConfirm:U,title:"Hapus Data Mahasiswa",message:"Apakah Anda yakin ingin menghapus data mahasiswa",itemName:h?`${h.nama} (${h.nim})`:""}),m&&e.jsx(se,{type:l.type,message:l.message,details:l.details,onClose:()=>{console.log("Toast onClose called"),x(!1)},duration:l.details?.length>0?8e3:5e3})]})}export{me as default};
