import{a as s,j as e,u as G,H as Q,b}from"./app-DDOQZFkl.js";import{S as X,H as Y}from"./Header-DP_l37zp.js";import{u as ee}from"./index.esm-Cvo2Bvr5.js";import{L as ae}from"./LoadingButton-l2N7JixB.js";import{I as te,D as se,T as re}from"./Toast-C0jjvyW7.js";/* empty css            */function H({show:i,onClose:h,onSubmit:y,formData:x,prodis:I,kelas:d,isEdit:o=!1,loading:m=!1}){const{register:r,handleSubmit:w,formState:{errors:t},reset:j,watch:u,setValue:p}=ee({defaultValues:x});s.useEffect(()=>{i&&j(x)},[i,x,j]);const c=u("prodi_id"),S=c?d?.filter(l=>l.prodi_id===parseInt(c)):d;if(s.useEffect(()=>{p("kelas_id","")},[c,p]),!i)return null;const v=l=>{y(l)};return e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50 flex items-start justify-center p-4",children:e.jsxs("div",{className:"relative top-4 md:top-10 mx-auto p-4 md:p-5 border w-full max-w-2xl shadow-lg rounded-md bg-white dark:bg-gray-800",children:[e.jsx("h3",{className:"text-lg font-medium leading-6 text-gray-900 dark:text-white mb-4",children:o?"Edit Data Mahasiswa":"Tambah Data Mahasiswa"}),e.jsxs("form",{onSubmit:w(v),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"NIM *"}),e.jsx("input",{type:"text",...r("nim",{required:"NIM wajib diisi"}),className:"w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm"}),t.nim&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:t.nim.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Nama *"}),e.jsx("input",{type:"text",...r("nama",{required:"Nama wajib diisi"}),className:"w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm"}),t.nama&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:t.nama.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Prodi *"}),e.jsxs("select",{...r("prodi_id",{required:"Prodi wajib dipilih"}),className:"w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm",children:[e.jsx("option",{value:"",children:"Pilih Prodi"}),I.map(l=>e.jsxs("option",{value:l.id,children:[l.nama_prodi," - ",l.fakultas?.nama_fakultas]},l.id))]}),t.prodi_id&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:t.prodi_id.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Kelas"}),e.jsxs("select",{...r("kelas_id"),className:"w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm",disabled:!c,children:[e.jsx("option",{value:"",children:"Pilih Kelas"}),S?.map(l=>e.jsxs("option",{value:l.id,children:[l.nama_kelas," - Semester ",l.semester]},l.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Angkatan *"}),e.jsx("input",{type:"number",...r("angkatan",{required:"Angkatan wajib diisi",min:{value:2e3,message:"Angkatan minimal 2000"}}),className:"w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm"}),t.angkatan&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:t.angkatan.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Jenis Kelamin *"}),e.jsxs("select",{...r("jenis_kelamin",{required:"Jenis kelamin wajib dipilih"}),className:"w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm",children:[e.jsx("option",{value:"L",children:"Laki-laki"}),e.jsx("option",{value:"P",children:"Perempuan"})]}),t.jenis_kelamin&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:t.jenis_kelamin.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Email *"}),e.jsx("input",{type:"email",...r("email",{required:"Email wajib diisi",pattern:{value:/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i,message:"Format email tidak valid"}}),className:"w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm"}),t.email&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:t.email.message})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Password ",o&&"(kosongkan jika tidak diubah)",!o&&" *"]}),e.jsx("input",{type:"password",...r("password",{required:o?!1:"Password wajib diisi",minLength:{value:6,message:"Password minimal 6 karakter"}}),className:"w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm"}),t.password&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:t.password.message})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Alamat"}),e.jsx("textarea",{rows:3,...r("alamat"),className:"w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm"})]})]}),e.jsxs("div",{className:"flex gap-2 mt-6",children:[e.jsx(ae,{type:"submit",loading:m,className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 disabled:opacity-50",children:o?"Update":"Simpan"}),e.jsx("button",{type:"button",onClick:h,disabled:m,className:"flex-1 bg-gray-300 dark:bg-gray-600 text-gray-700 dark:text-gray-300 px-4 py-2 rounded-md hover:bg-gray-400 dark:hover:bg-gray-500 disabled:opacity-50",children:"Batal"})]})]})]})})}function ce({mahasiswa:i,prodis:h,kelas:y,filters:x}){const d=G().props,[o,m]=s.useState(!1),[r,w]=s.useState({type:"info",message:"",details:[]});console.log("=== FULL PAGE PROPS ===",d),console.log("Props keys:",Object.keys(d)),console.log("Auth:",d.auth),console.log("Flash:",d.flash),console.log("Errors:",d.errors);const[t,j]=s.useState(()=>{if(typeof window<"u"){const a=localStorage.getItem("darkMode");return a!==null?a==="true":window.matchMedia("(prefers-color-scheme: dark)").matches}return!1}),[u,p]=s.useState(()=>typeof window<"u"?window.innerWidth>=1024:!0),[c,S]=s.useState(x.search||""),[v,l]=s.useState(x.prodi_id||""),[R,M]=s.useState(!1),[_,C]=s.useState(null),[B,L]=s.useState(!1),[$,E]=s.useState(!1),[q,P]=s.useState(!1),[g,f]=s.useState(null),[T,n]=s.useState(!1),[D,F]=s.useState({nim:"",nama:"",prodi_id:"",kelas_id:"",angkatan:"",jenis_kelamin:"L",alamat:"",email:"",password:""});s.useEffect(()=>{t?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),localStorage.setItem("darkMode",String(t))},[t]),s.useEffect(()=>{console.log("=== Flash Effect Triggered ==="),console.log("Props in effect:",d),console.log("Flash in effect:",d?.flash);const a=d?.flash;m(!1),setTimeout(()=>{a?.success?(console.log("Setting SUCCESS toast with message:",a.success),w({type:"success",message:a.success,details:a.import_errors||[]}),m(!0),console.log("Toast state set to TRUE")):a?.error&&(console.log("Setting ERROR toast with message:",a.error),w({type:"error",message:a.error,details:a.import_errors||[]}),m(!0),console.log("Toast state set to TRUE"))},100)},[d]);const A=()=>({nim:"",nama:"",prodi_id:"",kelas_id:"",angkatan:"",jenis_kelamin:"L",alamat:"",email:"",password:""}),K=a=>{a.preventDefault(),b.get("/admin/mahasiswa",{search:c,prodi_id:v},{preserveState:!0,replace:!0})},U=a=>{f(a),P(!0)},W=()=>{g&&b.post(`/admin/mahasiswa/${g?.id}`,{_method:"DELETE"},{onSuccess:()=>{P(!1),f(null)}})},z=()=>{F(A()),L(!0)},O=a=>{f(a),F({nim:a.nim,nama:a.nama,prodi_id:String(a.prodi_id),kelas_id:a.kelas_id?String(a.kelas_id):"",angkatan:String(a.angkatan),jenis_kelamin:a.jenis_kelamin,alamat:a.alamat||"",email:a.user?.email||"",password:""}),E(!0)},J=a=>{n(!0),b.post("/admin/mahasiswa",a,{onSuccess:()=>{L(!1),F(A()),n(!1)},onError:()=>{n(!1)},onFinish:()=>{n(!1)}})},V=a=>{n(!0),b.post(`/admin/mahasiswa/${g?.id}`,{...a,_method:"PUT"},{onSuccess:()=>{E(!1),f(null),n(!1)},onError:()=>{n(!1)},onFinish:()=>{n(!1)}})},Z=a=>{if(a.preventDefault(),!_){alert("Silakan pilih file terlebih dahulu");return}const N=new FormData;N.append("file",_),b.post("/admin/mahasiswa/import",N,{onSuccess:k=>{console.log("Import success:",k.props.flash),M(!1),C(null)},onError:k=>{console.log("Import errors:",k)}})};return console.log("Rendering toast check - showToast:",o,"toastConfig:",r),e.jsxs("div",{className:t?"dark":"",children:[e.jsxs("div",{className:"min-h-screen bg-gray-100 dark:bg-gray-900 transition-colors duration-300",children:[e.jsx(Q,{title:"Data Mahasiswa"}),e.jsx(X,{sidebarOpen:u,setSidebarOpen:p,activeMenu:"mahasiswa"}),e.jsxs("div",{className:`p-4 transition-all duration-300 ${u?"lg:ml-64":"lg:ml-0"}`,children:[e.jsx(Y,{sidebarOpen:u,setSidebarOpen:p,darkMode:t,setDarkMode:j,title:"Data Mahasiswa",subtitle:"Kelola data mahasiswa"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-wrap gap-3 justify-end",children:[e.jsxs("button",{onClick:()=>M(!0),className:"inline-flex items-center px-5 py-2.5 border border-transparent rounded-xl shadow-lg text-sm font-semibold text-white bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 transform hover:scale-105 transition-all duration-200",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),"Import Excel"]}),e.jsxs("button",{onClick:z,className:"inline-flex items-center px-5 py-2.5 border border-transparent rounded-xl shadow-lg text-sm font-semibold text-white bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 transform hover:scale-105 transition-all duration-200",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Tambah Mahasiswa"]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 shadow-xl rounded-2xl p-6 border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("svg",{className:"w-5 h-5 text-blue-600 dark:text-blue-400 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z",clipRule:"evenodd"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Pencarian & Filter"})]}),e.jsxs("form",{onSubmit:K,className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 md:gap-4",children:[e.jsx("div",{children:e.jsx("input",{type:"text",placeholder:"Cari NIM atau Nama...",value:c,onChange:a=>S(a.target.value),className:"w-full px-4 py-3 text-base border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-lg shadow-sm focus:border-blue-500 focus:ring-blue-500"})}),e.jsx("div",{children:e.jsxs("select",{value:v,onChange:a=>l(a.target.value),className:"w-full px-4 py-3 text-base border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-lg shadow-sm focus:border-blue-500 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Semua Prodi"}),h.map(a=>e.jsxs("option",{value:a.id,children:[a.nama_prodi," -"," ",a.fakultas?.nama_fakultas]},a.id))]})}),e.jsx("div",{children:e.jsxs("button",{type:"submit",className:"w-full inline-flex items-center justify-center bg-blue-600 hover:bg-blue-700 dark:bg-blue-700 dark:hover:bg-blue-800 text-white px-4 py-3 text-base font-semibold rounded-lg transition-colors",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),"Cari"]})})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 shadow-xl rounded-2xl overflow-hidden border border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"NIM"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Nama"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Prodi"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Kelas"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Angkatan"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Jenis Kelamin"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Aksi"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:i.data.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-6 py-4 text-center text-gray-500 dark:text-gray-400",children:"Tidak ada data mahasiswa"})}):i.data.map(a=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white",children:a.nim}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:a.nama}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:a.prodi?.nama_prodi}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:a.kelas?e.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",children:a.kelas.nama_kelas}):"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:a.angkatan}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:a.jenis_kelamin==="L"?"Laki-laki":"Perempuan"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>O(a),className:"inline-flex items-center justify-center p-2 rounded-lg bg-gradient-to-r from-blue-500 to-indigo-600 text-white hover:from-blue-600 hover:to-indigo-700 transform hover:scale-110 transition-all duration-200 shadow-md hover:shadow-lg",title:"Edit",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),e.jsx("button",{onClick:()=>U(a),className:"inline-flex items-center justify-center p-2 rounded-lg bg-gradient-to-r from-red-500 to-pink-600 text-white hover:from-red-600 hover:to-pink-700 transform hover:scale-110 transition-all duration-200 shadow-md hover:shadow-lg",title:"Hapus",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})})]},a.id))})]})}),i.links.length>3&&e.jsx("div",{className:"bg-white dark:bg-gray-800 px-4 py-3 border-t border-gray-200 dark:border-gray-700 sm:px-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4",children:[e.jsxs("div",{className:"text-sm text-gray-700 dark:text-gray-300",children:["Menampilkan ",i.from," -"," ",i.to," dari"," ",i.total," data"]}),e.jsx("div",{className:"flex gap-2",children:i.links.map((a,N)=>{const k=a.url?"a":"span";return e.jsx(k,{href:a.url||void 0,className:`px-3 py-1 rounded ${a.active?"bg-blue-600 text-white":"bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-600 border dark:border-gray-600"} ${!a.url&&"cursor-not-allowed opacity-50"}`,dangerouslySetInnerHTML:{__html:a.label}},N)})})]})})]})]})]})]}),e.jsx(te,{show:R,onClose:()=>{M(!1),C(null)},onSubmit:Z,file:_,setFile:C,templateUrl:"/admin/mahasiswa/template/download",entityName:"Mahasiswa"}),e.jsx(H,{show:B,onClose:()=>L(!1),onSubmit:J,formData:D,prodis:h,kelas:y,loading:T,isEdit:!1}),e.jsx(H,{show:$,onClose:()=>E(!1),onSubmit:V,formData:D,prodis:h,kelas:y,loading:T,isEdit:!0}),e.jsx(se,{show:q,onClose:()=>{P(!1),f(null)},onConfirm:W,title:"Hapus Data Mahasiswa",message:"Apakah Anda yakin ingin menghapus data mahasiswa",itemName:g?`${g.nama} (${g.nim})`:""}),o&&e.jsx(re,{type:r.type,message:r.message,details:r.details,onClose:()=>{console.log("Toast onClose called"),m(!1)},duration:r.details?.length>0?8e3:5e3})]})}export{ce as default};
